## Promise

–ö–ª–∞—Å—Å Promise —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤–æ –º–Ω–æ–≥–∏—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–≤–∏–∂–∫–∞—Ö JavaScript –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ –∑–∞–ø–æ–ª–∏—Ñ–∏–ª–µ–Ω. –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏—á–∏–Ω–æ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–∏—Å–æ–≤ —è–≤–ª—è–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å—Ç–∏–ª—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–ª–ª–±—ç–∫ —Å—Ç–∏–ª—è.

### –ö–æ–ª–ª–±—ç–∫ —Å—Ç–∏–ª—å

–ß—Ç–æ–±—ã –≤ –ø–æ–ª–Ω–æ–π –º–µ—Ä–µ –æ—Ü–µ–Ω–∏—Ç—å –ø—Ä–æ–º–∏—Å—ã, –¥–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é —Ç–æ–ª—å–∫–æ –∫–æ–ª–ª–±—ç–∫–æ–≤. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π —Å–æ–∑–¥–∞–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ JSON –∏–∑ —Ñ–∞–π–ª–∞. –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —ç—Ç–æ–≥–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π:

```ts
import fs = require('fs');

function loadJSONSync(filename: string) {
    return JSON.parse(fs.readFileSync(filename));
}

// –≤–∞–ª–∏–¥–Ω—ã–π json —Ñ–∞–π–ª
console.log(loadJSONSync('good.json'));

// –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª, –ø–æ—ç—Ç–æ–º—É fs.readFileSync –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π
try {
    console.log(loadJSONSync('absent.json'));
}
catch (err) {
    console.log('absent.json error', err.message);
}

// –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π json —Ñ–∞–π–ª —Ç.–µ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON, –ø–æ—ç—Ç–æ–º—É JSON.parse –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ—à–∏–±–∫–æ–π
try {
    console.log(loadJSONSync('invalid.json'));
}
catch (err) {
    console.log('invalid.json error', err.message);
}
```
–≠—Ç–∞ –ø—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è `loadJSONSync` –∏–º–µ–µ—Ç —Ç—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è: –≤–∞–ª–∏–¥–Ω–æ–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –æ—à–∏–±–∫–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ –æ—à–∏–±–∫–∞ JSON.parse. –ú—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—à–∏–±–∫–∏ —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Å—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ try / catch, –∫–∞–∫ –≤—ã –ø—Ä–∏–≤—ã–∫–ª–∏ –¥–µ–ª–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º —Ö–æ—Ä–æ—à—É—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Ç–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ù–µ–ø–ª–æ—Ö–∞—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ—à–∏–±–∫–∏ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```ts
import fs = require('fs');

// –ù–µ–ø–ª–æ—Ö–∞—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è .... –Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è. –ú—ã –æ–±—ä—è—Å–Ω–∏–º –ø—Ä–∏—á–∏–Ω—ã –Ω–∏–∂–µ
function loadJSON(filename: string, cb: (error: Error, data: any) => void) {
    fs.readFile(filename, function (err, data) {
        if (err) cb(err);
        else cb(null, JSON.parse(data));
    });
}
```
–í—Å—ë –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ, —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–ª–ª–±—ç–∫, –ø–µ—Ä–µ–¥–∞–≤–∞—è –µ–º—É –ª—é–±—ã–µ –æ—à–∏–±–∫–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã. –ï—Å–ª–∏ –Ω–µ—Ç –æ—à–∏–±–æ–∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã, –æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç `JSON.parse`. –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º–∏ –Ω–∞ –æ–±—Ä–∞—Ç–Ω—ã—Ö –≤—ã–∑–æ–≤–∞—Ö, —Å–ª–µ–¥—É–µ—Ç –ø–æ–º–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:

1. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–∑—ã–≤–∞–π—Ç–µ –∫–æ–ª–ª–±—ç–∫ –¥–≤–∞–∂–¥—ã.
2. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –±—Ä–æ—Å–∞–π—Ç–µ –æ—à–∏–±–∫—É.

–û–¥–Ω–∞–∫–æ —ç—Ç–∞ –ø—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ø—É–Ω–∫—Ç–∞. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏, `JSON.parse` –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –µ–º—É –ø–µ—Ä–µ–¥–∞–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π JSON, –≤ –∏—Ç–æ–≥–µ –∫–æ–ª–ª–±—ç–∫ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—ã–ª–µ—Ç–∞–µ—Ç. –≠—Ç–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ:

```ts
import fs = require('fs');

// –ù–µ–ø–ª–æ—Ö–∞—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è .... –Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
function loadJSON(filename: string, cb: (error: Error, data: any) => void) {
    fs.readFile(filename, function (err, data) {
        if (err) cb(err);
        else cb(null, JSON.parse(data));
    });
}

// –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ json
loadJSON('invalid.json', function (err, data) {
    // –≠—Ç–æ—Ç –∫–æ–¥ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è
    if (err) console.log('bad.json error', err.message);
    else console.log(data);
});
```

–ë—ã–ª–æ –±—ã –Ω–∞–∏–≤–Ω–æ–π –ø–æ–ø—ã—Ç–∫–æ–π –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ –æ–±–µ—Ä–Ω—É—Ç—å `JSON.parse` –≤ try/catch, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ:

```ts
import fs = require('fs');

// –í–µ—Ä—Å–∏—è –ø–æ–ª—É—á—à–µ .... –Ω–æ –≤—Å—ë –µ—â—ë –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
function loadJSON(filename: string, cb: (error: Error) => void) {
    fs.readFile(filename, function (err, data) {
        if (err) {
            cb(err);
        }
        else {
            try {
                cb(null, JSON.parse(data));
            }
            catch (err) {
                cb(err);
            }
        }
    });
}

// –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ json
loadJSON('invalid.json', function (err, data) {
    if (err) console.log('bad.json error', err.message);
    else console.log(data);
});
```

–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –≤ —ç—Ç–æ–º –∫–æ–¥–µ –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è –æ—à–∏–±–∫–∞. –ï—Å–ª–∏ –∫–æ–ª–ª–±—ç–∫ (`cb`), –∞ –Ω–µ `JSON.parse`, –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É, —Ç–∞–∫ –∫–∞–∫ –º—ã –∑–∞–≤–µ—Ä–Ω—É–ª–∏ –µ–µ –≤ `try` /` catch`, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `catch`, –∏ –º—ã —Å–Ω–æ–≤–∞ –≤—ã–∑—ã–≤–∞–µ–º –∫–æ–ª–ª–±—ç–∫, —Ç.–µ. –≤—ã–∑—ã–≤–∞–µ–º –¥–≤–∞–∂–¥—ã! –≠—Ç–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ –ø—Ä–∏–º–µ—Ä–µ –Ω–∏–∂–µ:

```ts
import fs = require('fs');

function loadJSON(filename: string, cb: (error: Error) => void) {
    fs.readFile(filename, function (err, data) {
        if (err) {
            cb(err);
        }
        else {
            try {
                cb(null, JSON.parse(data));
            }
            catch (err) {
                cb(err);
            }
        }
    });
}

// –≤–∞–ª–∏–¥–Ω—ã–π —Ñ–∞–π–ª, –Ω–æ –ø–ª–æ—Ö–æ–π –∫–æ–ª–ª–±—ç–∫ ... –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–Ω–æ–≤–∞!
loadJSON('good.json', function (err, data) {
    console.log('our callback called');

    if (err) console.log('Error:', err.message);
    else {
        // –¥–∞–≤–∞–π—Ç–µ –∏–º–∏—Ç–∏—Ä—É–µ–º –æ—à–∏–±–∫—É, –ø—ã—Ç–∞—è—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–π—Å—Ç–≤—É –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
        var foo;
        // –°–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –≤—ã–±—Ä–æ—Å–∏—Ç –æ—à–∏–±–∫—É `Error: Cannot read property 'bar' of undefined`
        console.log(foo.bar);
    }
});
```

```bash
$ node asyncbadcatchdemo.js
our callback called
our callback called
Error: Cannot read property 'bar' of undefined
```

–≠—Ç–æ –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è `loadJSON` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–≤–µ—Ä–Ω—É–ª–∞ –∫–æ–ª–ª–±—ç–∫ –≤ –±–ª–æ–∫ `try`. –ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ.

> –ü—Ä–æ—Å—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –¥–µ—Ä–∂–∏—Ç–µ –≤–µ—Å—å –≤–∞—à —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ –≤ try catch, –∫—Ä–æ–º–µ —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –≤—ã –≤—ã–∑—ã–≤–∞–µ—Ç–µ –∫–æ–ª–ª–±—ç–∫.

–°–ª–µ–¥—É—è —ç—Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ–º—É –ø—Ä–∞–≤–∏–ª—É –º—ã –∏–º–µ–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é `loadJSON`, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ:

```ts
import fs = require('fs');

function loadJSON(filename: string, cb: (error: Error) => void) {
    fs.readFile(filename, function (err, data) {
        if (err) return cb(err);
        // –î–µ—Ä–∂–∏–º –≤–µ—Å—å –≤–∞—à —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ –≤ try catch
        try {
            var parsed = JSON.parse(data);
        }
        catch (err) {
            return cb(err);
        }
        // –∫—Ä–æ–º–µ —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –≤—ã –≤—ã–∑—ã–≤–∞–µ—Ç–µ –∫–æ–ª–ª–±—ç–∫
        return cb(null, parsed);
    });
}
```
–ö–æ–Ω–µ—á–Ω–æ —ç—Ç–æ–º—É –ª–µ–≥–∫–æ —Å–ª–µ–¥–æ–≤–∞—Ç—å, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –≤—ã —É–∂–µ –ø—Ä–æ–¥–µ–ª–∞–ª–∏ —ç—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –Ω–æ, —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ, —ç—Ç–æ –º–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å –ø—Ä–æ—Å—Ç–æ –¥–ª—è —Ö–æ—Ä–æ—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –±–æ–ª–µ–µ –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –±–æ—Ä—å–±—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º JavaScript –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ–º–∏—Å—ã.

## –°–æ–∑–¥–∞–Ω–∏–µ Promise

–ü—Ä–æ–º–∏—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –æ–∂–∏–¥–∞–Ω–∏–µ(`pending`), –∏—Å–ø–æ–ª–Ω–µ–Ω–æ(`fulfilled`) –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ(`rejected`).

![—Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–º–∏—Å–∞ –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –µ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è](https://raw.githubusercontent.com/basarat/typescript-book/master/images/promise%20states%20and%20fates.png)

–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–∏—Å–∞. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Å—Ç–æ –≤—ã–∑–≤–∞—Ç—å `new` —Å `Promise` (–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–æ–º–∏—Å–æ–≤). –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø—Ä–æ–º–∏—Å–æ–≤ –ø–µ—Ä–µ–¥–∞—Å—Ç `resolve` –∏ `reject` —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–º–∏—Å–∞:

```ts
const promise = new Promise((resolve, reject) => {
    // resolve / reject —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–º–∏—Å–∞
});
```

### –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–º–∏—Å–∞

–ù–∞ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–º–∏—Å–∞ –º–æ–∂–Ω–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è —Å –ø–æ–º–æ—â—å—é `.then` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–æ) –∏–ª–∏` .catch` (–µ—Å–ª–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ).

```ts
const promise = new Promise((resolve, reject) => {
    resolve(123);
});
promise.then((res) => {
    console.log('I get called:', res === 123); // I get called: true
});
promise.catch((err) => {
    // –ù–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–æ
});
```

```ts
const promise = new Promise((resolve, reject) => {
    reject(new Error("Something awful happened"));
});
promise.then((res) => {
    // –ù–µ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–æ
});
promise.catch((err) => {
    console.log('I get called:', err.message); // I get called: 'Something awful happened'
});
```

> –°–û–í–ï–¢: —à–æ—Ä—Ç–∫–∞—Ç—ã –¥–ª—è –ø—Ä–æ–º–∏—Å–∞
* –ë—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–∏—Å–∞: `Promise.resolve(result)`
* –ë—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–∏—Å–∞: `Promise.reject(error)`

### –¶–µ–ø–æ—á–∫–∏ –ø—Ä–æ–º–∏—Å–æ–≤
–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ü–µ–ø–æ—á–∫–∏ –≤—ã–∑–æ–≤–∞ –ø—Ä–æ–º–∏—Å–æ–≤ **—ç—Ç–æ –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –ø—Ä–æ–º–∏—Å—ã**. –ö–∞–∫ —Ç–æ–ª—å–∫–æ —É –≤–∞—Å –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–º–∏—Å, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `then` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏ –ø—Ä–æ–º–∏—Å–æ–≤.

* –ï—Å–ª–∏ –≤—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç–µ –ø—Ä–æ–º–∏—Å –∏–∑ –ª—é–±–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ü–µ–ø–æ—á–∫–µ, `.then` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ resolved:

```ts
Promise.resolve(123)
    .then((res) => {
        console.log(res); // 123
        return 456;
    })
    .then((res) => {
        console.log(res); // 456
        return Promise.resolve(123); // –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–º–∏—Å
    })
    .then((res) => {
        console.log(res); // 123 : –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ—Ç `then` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º resolved
        return 123;
    })
```
* –í—ã –º–æ–∂–µ—Ç–µ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –ª—é–±–æ–π –ø—Ä–µ–¥—ã–¥—É—â–µ–π —á–∞—Å—Ç–∏ —Ü–µ–ø–æ—á–∫–∏ —Å –ø–æ–º–æ—â—å—é –æ–¥–Ω–æ–≥–æ `catch`:

```ts
// –°–æ–∑–¥–∞—ë–º rejected –ø—Ä–æ–º–∏—Å
Promise.reject(new Error('something bad happened'))
    .then((res) => {
        console.log(res); // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
        return 456;
    })
    .then((res) => {
        console.log(res); // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
        return 123;
    })
    .then((res) => {
        console.log(res); // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
        return 123;
    })
    .catch((err) => {
        console.log(err.message); // —Å–ª—É—á–∏–ª–æ—Å—å —á—Ç–æ-—Ç–æ –ø–ª–æ—Ö–æ–µ
    });
```

* `—Åatch` —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ–º–∏—Å (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—è –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É –ø—Ä–æ–º–∏—Å–æ–≤):

```ts
// –°–æ–∑–¥–∞—ë–º rejected –ø—Ä–æ–º–∏—Å
Promise.reject(new Error('something bad happened'))
    .then((res) => {
        console.log(res); // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
        return 456;
    })
    .catch((err) => {
        console.log(err.message); // —Å–ª—É—á–∏–ª–æ—Å—å —á—Ç–æ-—Ç–æ –ø–ª–æ—Ö–æ–µ
        return 123;
    })
    .then((res) => {
        console.log(res); // 123
    })
```

* –õ—é–±—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –≤ `then` (–∏–ª–∏ `catch`), –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π –ø—Ä–æ–º–∏—Å –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è:

```ts
Promise.resolve(123)
    .then((res) => {
        throw new Error('something bad happened'); // –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ—à–∏–±–∫—É
        return 456;
    })
    .then((res) => {
        console.log(res); // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
        return Promise.resolve(789);
    })
    .catch((err) => {
        console.log(err.message); // —Å–ª—É—á–∏–ª–æ—Å—å —á—Ç–æ-—Ç–æ –ø–ª–æ—Ö–æ–µ
    })
```

* –¢–æ–ª—å–∫–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π (–±–ª–∏–∂–∞–π—à–∏–π) `catch` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –¥–∞–Ω–Ω–æ–π –æ—à–∏–±–∫–∏ (—Ç–∞–∫ –∫–∞–∫ catch –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—É—é —Ü–µ–ø–æ—á–∫—É –ø—Ä–æ–º–∏—Å–æ–≤).

```ts
Promise.resolve(123)
    .then((res) => {
        throw new Error('something bad happened'); // –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ—à–∏–±–∫—É
        return 456;
    })
    .catch((err) => {
        console.log('first catch: ' + err.message); // —Å–ª—É—á–∏–ª–æ—Å—å —á—Ç–æ-—Ç–æ –ø–ª–æ—Ö–æ–µ
        return 123;
    })
    .then((res) => {
        console.log(res); // 123
        return Promise.resolve(789);
    })
    .catch((err) => {
        console.log('second catch: ' + err.message); // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
    })
```

* `—Åatch` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Ü–µ–ø–æ—á–∫–µ:

```ts
Promise.resolve(123)
    .then((res) => {
        return 456;
    })
    .catch((err) => {
        console.log("HERE"); // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
    })
```

–î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ:

* –æ—à–∏–±–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –∫ `catch` (–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç –ª—é–±—ã–µ —Å—Ä–µ–¥–Ω–∏–µ –≤—ã–∑–æ–≤—ã` then`) –∏
* —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ —Ç–∞–∫–∂–µ –æ—Ç–ª–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ª—é–±—ã–º `catch`.

—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –Ω–∞–º –ø–∞—Ä–∞–¥–∏–≥–º—É –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –ª—É—á—à–µ —á–µ–º –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∫–æ–ª–ª–±—ç–∫–∏. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± —ç—Ç–æ–º –Ω–∏–∂–µ.


### TypeScript –∏ –ø—Ä–æ–º–∏—Å—ã
–û—Ç–ª–∏—á–∏—Ç–µ–ª—å–Ω–æ–π –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å—é TypeScript —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –æ–Ω –ø–æ–Ω–∏–º–∞–µ—Ç –ø–æ—Ç–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É –ø—Ä–æ–º–∏—Å–æ–≤:

```ts
Promise.resolve(123)
    .then((res) => {
         // res –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Ç–∏–ø `number`
         return true;
    })
    .then((res) => {
        // res –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Ç–∏–ø `boolean`

    });
```

–ö–æ–Ω–µ—á–Ω–æ, –æ–Ω —Ç–∞–∫–∂–µ –ø–æ–Ω–∏–º–∞–µ—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ª—é–±—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ–º–∏—Å:

```ts
function iReturnPromiseAfter1Second(): Promise<string> {
    return new Promise((resolve) => {
        setTimeout(() => resolve("Hello world!"), 1000);
    });
}

Promise.resolve(123)
    .then((res) => {
        // res –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Ç–∏–ø `number`
        return iReturnPromiseAfter1Second(); // –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º `Promise<string>`
    })
    .then((res) => {
        // res –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Ç–∏–ø `string`
        console.log(res); // Hello world!
    });
```


### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–ª–ª–±—ç–∫–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø—Ä–æ–º–∏—Å–∞

–ü—Ä–æ—Å—Ç–æ –æ–±–µ—Ä–Ω–∏—Ç–µ –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ø—Ä–æ–º–∏—Å –∏
- `reject` –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞,
- `resolve` –µ—Å–ª–∏ –≤—Å–µ —Ö–æ—Ä–æ—à–æ.

–ù–∞–ø—Ä–∏–º–µ—Ä. –¥–∞–≤–∞–π—Ç–µ –∑–∞–≤–µ—Ä–Ω–µ–º `fs.readFile`:

```ts
import fs = require('fs');
function readFileAsync(filename: string): Promise<any> {
    return new Promise((resolve,reject) => {
        fs.readFile(filename,(err,result) => {
            if (err) reject(err);
            else resolve(result);
        });
    });
}
```


### –í–æ–∑–≤—Ä–∞—â–∞—è—Å—å –∫ –ø—Ä–∏–º–µ—Ä—É —Å JSON

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –≤–µ—Ä–Ω–µ–º—Å—è –∫ –Ω–∞—à–µ–º—É –ø—Ä–∏–º–µ—Ä—É `loadJSON` –∏ –ø–µ—Ä–µ–ø–∏—à–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–º–∏—Å—ã. –í—Å–µ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∫–∞–∫ –ø—Ä–æ–º–∏—Å, –∑–∞—Ç–µ–º –ø–∞—Ä—Å–∏–º –µ–≥–æ –∫–∞–∫ JSON, –∏ –≤—Å–µ –≥–æ—Ç–æ–≤–æ. –≠—Ç–æ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ:

```ts
function loadJSONAsync(filename: string): Promise<any> {
    return readFileAsync(filename) // Use the function we just wrote
                .then(function (res) {
                    return JSON.parse(res);
                });
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é `sync`, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –≤ –Ω–∞—á–∞–ª–µ —ç—Ç–æ–≥–æ —Ä–∞–∑–¥–µ–ª–∞ üåπ):
```ts
// –≤–∞–ª–∏–¥–Ω—ã–π json —Ñ–∞–π–ª
loadJSONAsync('good.json')
    .then(function (val) { console.log(val); })
    .catch(function (err) {
        console.log('good.json error', err.message); // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
    })

// –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π json —Ñ–∞–π–ª
    .then(function () {
        return loadJSONAsync('absent.json');
    })
    .then(function (val) { console.log(val); }) // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
    .catch(function (err) {
        console.log('absent.json error', err.message);
    })

// –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π json —Ñ–∞–π–ª
    .then(function () {
        return loadJSONAsync('invalid.json');
    })
    .then(function (val) { console.log(val); }) // –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
    .catch(function (err) {
        console.log('bad.json error', err.message);
    });
```

–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ—â–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–∏—Å–æ–≤ –ø—Ä–æ–∏–∑–≤–µ–ª–æ "`loadFile`(async) + `JSON.parse` (sync) => `catch`" –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ. –¢–∞–∫–∂–µ –∫–æ–ª–ª–±—ç–∫ –Ω–µ –±—ã–ª –≤—ã–∑–≤–∞–Ω *–Ω–∞–º–∏*, –Ω–æ –≤—ã–∑–≤–∞–Ω —Ü–µ–ø–æ—á–∫–æ–π –ø—Ä–æ–º–∏—Å–æ–≤, –ø–æ—ç—Ç–æ–º—É —É –Ω–∞—Å –Ω–µ –±—ã–ª–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ–≤–µ—Ä—à–∏—Ç—å –æ—à–∏–±–∫—É, –∑–∞–∫–ª—é—á–∏–≤ –µ–≥–æ –≤ `try / catch`.

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–º
–ú—ã –≤–∏–¥–µ–ª–∏, –∫–∞–∫ –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–µ—Ä–∏—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —Å –ø—Ä–æ–º–∏—Å–∞–º–∏. –ü—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ü–µ–ø–æ—á–∫–∏ –≤—ã–∑–æ–≤–æ–≤ `then`.

–û–¥–Ω–∞–∫–æ –≤—ã, –≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞—Ö–æ—Ç–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–µ—Ä–∏—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á, –∞ –∑–∞—Ç–µ–º —á—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞—Ç—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤—Å–µ—Ö —ç—Ç–∏—Ö –∑–∞–¥–∞—á. `Promise` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é `Promise.all`, –∫–æ—Ç–æ—Ä—É—é –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `n` –ø—Ä–æ–º–∏—Å–æ–≤. –í—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç–µ –µ–º—É –º–∞—Å—Å–∏–≤ `n` –ø—Ä–æ–º–∏—Å–æ–≤, –∏ –æ–Ω –¥–∞–µ—Ç –≤–∞–º –º–∞—Å—Å–∏–≤ `n` resolve –∑–Ω–∞—á–µ–Ω–∏–π. –ù–∏–∂–µ –º—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ –ø–æ —Ü–µ–ø–æ—á–∫–µ, –∞ —Ç–∞–∫–∂–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:

```ts
// –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ —Å–µ—Ä–≤–µ—Ä–∞
function loadItem(id: number): Promise<{ id: number }> {
    return new Promise((resolve) => {
        console.log('loading item', id);
        setTimeout(() => { // –∏–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–¥–µ—Ä–∂–∫—É —Å–µ—Ä–≤–µ—Ä–∞
            resolve({ id: id });
        }, 1000);
    });
}

// –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ –ø–æ —Ü–µ–ø–æ—á–∫–µ
let item1, item2;
loadItem(1)
    .then((res) => {
        item1 = res;
        return loadItem(2);
    })
    .then((res) => {
        item2 = res;
        console.log('done');
    }); // –æ–±—â–µ–µ –≤—Ä–µ–º—è –±—É–¥–µ—Ç –æ–∫–æ–ª–æ 2—Å.

// –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –≤—ã–∑–æ–≤
Promise.all([loadItem(1), loadItem(2)])
    .then((res) => {
        [item1, item2] = res;
        console.log('done');
    }); // –æ–±—â–µ–µ –≤—Ä–µ–º—è –±—É–¥–µ—Ç –æ–∫–æ–ª–æ 1—Å.
```

–ò–Ω–æ–≥–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–∏—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á, –Ω–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –≤—Å–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ, –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏ —á—Ç–æ –±—É–¥–µ—Ç —Ä–µ—à–µ–Ω–∞ –ª—é–±–∞—è –∏–∑ —ç—Ç–∏—Ö –∑–∞–¥–∞—á. `Promise` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é `Promise.race` –¥–ª—è —ç—Ç–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è:

```ts
var task1 = new Promise(function(resolve, reject) {
    setTimeout(resolve, 1000, 'one');
});
var task2 = new Promise(function(resolve, reject) {
    setTimeout(resolve, 2000, 'two');
});

Promise.race([task1, task2]).then(function(value) {
  console.log(value); // "one"
  // –∏—Å–ø–æ–ª–Ω–µ–Ω—ã –æ–±–µ, –Ω–æ task1 –∏—Å–ø–æ–ª–Ω–∏–ª—Å—è –±—ã—Å—Ç—Ä–µ–µ
});
```

### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫–æ–ª–ª–±—ç–∫–æ–≤ –≤ –ø—Ä–æ–º–∏—Å

–°–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –≤—Ä—É—á–Ω—É—é. –ù–∞–ø—Ä–∏–º–µ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å `setTimeout` –≤ –ø—Ä–æ–º–∏—Å `delay` –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ:

```ts
const delay = (ms: number) => new Promise(res => setTimeout(res, ms));
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤ NodeJS –µ—Å—Ç—å —Å—É–ø–µ—Ä-—É–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–æ—Ç —Ç–∞–∫—É—é `node style function => promise returning function` –º–∞–≥–∏—é –¥–ª—è –≤–∞—Å:

```ts
/** –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è */
import fs = require('fs');
import util = require('util');
const readFile = util.promisify(fs.readFile);
```

[polyfill]:https://github.com/stefanpenner/es6-promise
